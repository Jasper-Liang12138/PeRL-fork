# vLLM + NPU 环境依赖
# 适用于华为昇腾NPU的GRPO训练环境
# 华为昇腾910B
# 基于 ubuntu22.04-teleformers-cann8.2.rc1-npu:v0.2.0.post1.ssh

# 核心深度学习框架
torch==2.9.0
torch-npu==2.9.0

# vLLM及其NPU支持（仅用于评估和推理）
vllm==0.15.1
vllm-ascend==0.13.0

# Transformers和相关
transformers==4.57.6
tokenizers==0.22.2
accelerate>=0.20.0

# TRL - 稳定版本（训练时不使用vLLM）
trl==0.14.0

# DeepSpeed
deepspeed>=0.14.0

# 数据处理
datasets==4.5.0
numpy<2.0.0  # vllm-ascend要求
pandas>=2.0.0

# PEFT (参数高效微调)
peft>=0.8.0

# 其他依赖
opencv-python-headless==4.13.0.92
fsspec==2025.10.0
scipy>=1.10.0
scikit-learn>=1.3.0
wandb>=0.15.0
pyyaml>=6.0
tqdm>=4.65.0
packaging>=23.0

# 注意事项：
# 1. TRL 0.14.0 在训练时不支持vLLM，但vLLM可用于训练后的评估和推理
# 2. vLLM版本冲突说明：
#    - TRL 0.18.0+ 支持vLLM，但仅支持vLLM 0.10-0.12
#    - vllm-ascend 0.13.0 需要vLLM 0.13.0+
#    - 这两者无法兼容，因此训练时禁用vLLM
# 3. torch版本必须是2.9.0以匹配torch-npu 2.9.0
# 4. numpy必须<2.0.0以兼容vllm-ascend
